<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 8 - Advanced Mid-term Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 25px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        }
        header {
            text-align: center;
            border-bottom: 3px solid #007bff;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        header h1 {
            color: #007bff;
            margin: 0;
            font-size: 2.2em;
        }
        header p {
            font-size: 1.2em;
            color: #555;
            font-weight: 500;
        }
        .section-title {
            color: #d9534f;
            font-size: 1.6em;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        .question-group {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fdfdfd;
            transition: border-color 0.3s;
        }
        .question-group.correct {
            border-left: 5px solid #28a745;
            background-color: #f0fff4;
        }
        .question-group.incorrect {
            border-left: 5px solid #dc3545;
            background-color: #fff6f6;
        }
        .question-group p {
            font-weight: 600;
            font-size: 1.1em;
            margin-top: 0;
        }
        .mcq-option {
            display: block;
            margin: 8px 0 8px 20px;
            cursor: pointer;
            font-weight: 500;
        }
        .reading-passage {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 5px;
            font-style: italic;
            margin-bottom: 15px;
        }
        input[type="text"] {
            width: 95%;
            padding: 10px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: inherit;
        }
        .submit-button {
            display: block;
            width: 100%;
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 30px;
            transition: background-color 0.3s, transform 0.2s;
        }
        .submit-button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        .final-result-box {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            display: none; /* Ẩn ban đầu */
        }
        .correct-answer-display {
            font-weight: bold;
            color: #1967d2;
            margin-top: 10px;
            font-style: italic;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Bài kiểm tra Giữa kỳ (Nâng cao)</h1>
            <p>Tiếng Anh Lớp 8 - Chân trời sáng tạo (Units 1-3)</p>
        </header>

        <form id="quizForm">
            <h2 class="section-title">I. Phonetics</h2>
            
            <div class="question-group" id="q-group-1">
                <p>1. Which word has a different sound for the underlined part?</p>
                <label class="mcq-option"><input type="radio" name="q1" value="a"> comm<u>u</u>nal</label>
                <label class="mcq-option"><input type="radio" name="q1" value="b"> c<u>u</u>stoms</label>
                <label class="mcq-option"><input type="radio" name="q1" value="c"> m<u>u</u>sical</label>
                <label class="mcq-option"><input type="radio" name="q1" value="d"> c<u>u</u>ltural</label>
                <div class="correct-answer-display" id="ca1"></div>
            </div>
            
            <div class="question-group" id="q-group-2">
                <p>2. Which word has a different stress pattern?</p>
                <label class="mcq-option"><input type="radio" name="q2" value="a"> sedentary</label>
                <label class="mcq-option"><input type="radio" name="q2" value="b"> avocation</label>
                <label class="mcq-option"><input type="radio" name="q2" value="c"> picturesque</label>
                <label class="mcq-option"><input type="radio" name="q2" value="d"> ethnicity</label>
                <div class="correct-answer-display" id="ca2"></div>
            </div>

            <h2 class="section-title">II. Grammar & Vocabulary</h2>
            
            <div class="question-group" id="q-group-3">
                <p>3. ______ his meticulous collecting of antique coins that won him the award.</p>
                <label class="mcq-option"><input type="radio" name="q3" value="a"> It was</label>
                <label class="mcq-option"><input type="radio" name="q3" value="b"> It is</label>
                <label class="mcq-option"><input type="radio" name="q3" value="c"> That was</label>
                <label class="mcq-option"><input type="radio" name="q3" value="d"> There was</label>
                <div class="correct-answer-display" id="ca3"></div>
            </div>
            
            <div class="question-group" id="q-group-4">
                <p>4. Many people prefer the ______ of the countryside, as the city is too noisy.</p>
                <label class="mcq-option"><input type="radio" name="q4" value="a"> tranquil</label>
                <label class="mcq-option"><input type="radio" name="q4" value="b"> tranquilize</label>
                <label class="mcq-option"><input type="radio" name="q4" value="c"> tranquility</label>
                <label class="mcq-option"><input type="radio" name="q4" value="d"> tranquilly</label>
                <div class="correct-answer-display" id="ca4"></div>
            </div>

            <div class="question-group" id="q-group-5">
                <p>5. I absolutely ______ being forced to listen to that kind of music; it's dreadful.</p>
                <label class="mcq-option"><input type="radio" name="q5" value="a"> fancy</label>
                <label class="mcq-option"><input type="radio" name="q5" value="b"> adore</label>
                <label class="mcq-option"><input type="radio" name="q5" value="c"> am keen on</label>
                <label class="mcq-option"><input type="radio" name="q5" value="d"> loathe</label>
                <div class="correct-answer-display" id="ca5"></div>
            </div>

            <h2 class="section-title">III. Reading</h2>
            <div class="reading-passage">
                <p>The 54 ethnic groups of Vietnam are a testament to the country's rich cultural diversity. Each group, while contributing to the unified tapestry of the nation, maintains its own unique customs, language, and traditional attire. The Viet (Kinh) people account for the vast majority of the population and predominantly inhabit the lowlands. In contrast, the other 53 ethnic minority groups are largely found in the mountainous regions and highlands, areas that are often less developed. These groups face unique challenges, including the preservation of their traditional lifestyles against the backdrop of rapid modernization and economic development. Their agricultural practices, such as terraced rice farming, are not just a means of subsistence but also a spectacular cultural landscape that attracts tourism, which itself presents both opportunities and risks for their cultural preservation.</p>
            </div>
            
            <div class="question-group" id="q-group-6">
                <p>6. According to the passage, what is a primary challenge for ethnic minority groups?</p>
                <label class="mcq-option"><input type="radio" name="q6" value="a"> They are not interested in tourism.</label>
                <label class="mcq-option"><input type="radio" name="q6" value="b"> They make up the majority of the population.</label>
                <label class="mcq-option"><input type="radio" name="q6" value="c"> Balancing modernization with cultural preservation.</label>
                <label class="mcq-option"><input type="radio" name="q6" value="d"> Their farms are not productive enough.</label>
                <div class="correct-answer-display" id="ca6"></div>
            </div>
            
            <div class="question-group" id="q-group-7">
                <p>7. What can be inferred about terraced rice farming?</p>
                <label class="mcq-option"><input type="radio" name="q7" value="a"> It is practiced mainly by the Viet (Kinh) people.</label>
                <label class="mcq-option"><input type="radio" name="q7" value="b"> It has both cultural and economic significance.</label>
                <label class="mcq-option"><input type="radio" name="q7" value="c"> It is a modern farming technique.</label>
                <label class="mcq-option"><input type="radio" name="q7" value="d"> It is damaging the environment in the highlands.</label>
                <div class="correct-answer-display" id="ca7"></div>
            </div>

            <h2 class="section-title">IV. Writing</h2>
            
            <div class="question-group" id="q-group-8">
                <p>8. (Word Formation) Life in this idyllic village gives me a sense of peace and ______.</p>
                <input type="text" id="ans8" placeholder="Điền dạng đúng của từ: TRANQUIL">
                <div class="correct-answer-display" id="ca8"></div>
            </div>
            
            <div class="question-group" id="q-group-9">
                <p>9. (Error Correction) Find and correct ONE mistake: <br><i>There are much unique customs belonging to the ethnic groups in the highlands.</i></p>
                <input type="text" id="ans9" placeholder="Viết lại CẢ CÂU đúng...">
                <div class="correct-answer-display" id="ca9"></div>
            </div>
            
            <div class="question-group" id="q-group-10">
                <p>10. (Sentence Transformation) Rewrite the sentence:<br><i>As the countryside becomes more idyllic, more people want to move there.</i></p>
                <input type="text" id="ans10" placeholder="Bắt đầu bằng: The more idyllic...">
                <div class="correct-answer-display" id="ca10"></div>
            </div>

            <button type="button" class="submit-button" onclick="calculateScore()">Nộp bài và Chấm điểm</button>
            
            <div id="final-result" class="final-result-box"></div>

        </form>
    </div>

    <script>
        // JavaScript để chấm điểm
        function calculateScore() {
            let score = 0;
            const totalQuestions = 10;
            
            // Định nghĩa đáp án đúng
            const correctAnswers = {
                q1: 'a', // comm(u)nal /ə/, others /ʌ/
                q2: 'c', // picturesque (stress 3), others stress 2
                q3: 'a', // Cleft sentence (won = past)
                q4: 'c', // Noun form
                q5: 'd', // 'loathe' = strong hate
                q6: 'c', // Reading - preservation vs modernization
                q7: 'b', // Reading - subsistence + tourism
                ans8: 'tranquility',
                ans9: 'There are many unique customs belonging to the ethnic groups in the highlands.',
                ans10: 'The more idyllic the countryside becomes, the more people want to move there.'
            };

            // Hàm chuẩn hóa câu trả lời viết
            function normalize(str) {
                return str.trim().toLowerCase().replace(/\.$/, ''); // Bỏ cách, chữ hoa, dấu chấm cuối
            }

            // Mảng chứa các hàm kiểm tra cho từng câu
            const checks = [
                // Q1 - MCQ
                () => checkMCQ('q1', correctAnswers.q1),
                // Q2 - MCQ
                () => checkMCQ('q2', correctAnswers.q2),
                // Q3 - MCQ
                () => checkMCQ('q3', correctAnswers.q3),
                // Q4 - MCQ
                () => checkMCQ('q4', correctAnswers.q4),
                // Q5 - MCQ
                () => checkMCQ('q5', correctAnswers.q5),
                // Q6 - MCQ (Reading)
                () => checkMCQ('q6', correctAnswers.q6),
                // Q7 - MCQ (Reading)
                () => checkMCQ('q7', correctAnswers.q7),
                // Q8 - Writing (Word Form)
                () => checkText('ans8', correctAnswers.ans8),
                // Q9 - Writing (Error)
                () => checkText('ans9', correctAnswers.ans9),
                // Q10 - Writing (Transform)
                () => checkText('ans10', correctAnswers.ans10)
            ];

            // Lặp qua và chấm điểm
            for (let i = 0; i < checks.length; i++) {
                if (checks[i]()) {
                    score++;
                }
            }

            // --- Hàm kiểm tra con ---
            function checkMCQ(questionName, correctAnswer) {
                const qNum = questionName.replace('q', '');
                clearFeedback(qNum);
                const selectedOption = document.querySelector('input[name="' + questionName + '"]:checked');
                
                if (selectedOption) {
                    if (selectedOption.value === correctAnswer) {
                        addFeedback(qNum, 'correct');
                        return true;
                    } else {
                        addFeedback(qNum, 'incorrect', 'Đáp án đúng: ' + correctAnswer.toUpperCase());
                        return false;
                    }
                } else {
                    addFeedback(qNum, 'incorrect', 'Bạn chưa chọn đáp án. Đúng là: ' + correctAnswer.toUpperCase());
                    return false;
                }
            }
            
            function checkText(inputId, correctAnswer) {
                const qNum = inputId.replace('ans', '');
                clearFeedback(qNum);
                const userAnswer = document.getElementById(inputId).value;
                
                if (normalize(userAnswer) === normalize(correctAnswer)) {
                    addFeedback(qNum, 'correct');
                    return true;
                } else {
                    addFeedback(qNum, 'incorrect', 'Đáp án đúng: ' + correctAnswer);
                    return false;
                }
            }

            // --- Hàm hiển thị feedback ---
            function addFeedback(qNum, status, answerText = '') {
                const group = document.getElementById('q-group-' + qNum) || document.getElementById('q-group-' + qNum.replace('ans', ''));
                const answerDisplay = document.getElementById('ca' + qNum) || document.getElementById('ca' + qNum.replace('ans', ''));
                
                group.classList.add(status);
                
                if (status === 'incorrect' && answerText) {
                    answerDisplay.innerText = answerText;
                }
            }

            function clearFeedback(qNum) {
                const group = document.getElementById('q-group-' + qNum) || document.getElementById('q-group-' + qNum.replace('ans', ''));
                const answerDisplay = document.getElementById('ca' + qNum) || document.getElementById('ca' + qNum.replace('ans', ''));
                
                group.classList.remove('correct', 'incorrect');
                answerDisplay.innerText = '';
            }

            // Hiển thị kết quả cuối cùng
            const resultDisplay = document.getElementById('final-result');
            resultDisplay.innerHTML = `<h2>Kết quả của bạn: ${score} / ${totalQuestions}</h2>`;
            
            if (score < 5) {
                resultDisplay.style.backgroundColor = '#fdecea';
                resultDisplay.style.color = '#5a1e22';
            } else if (score < 8) {
                resultDisplay.style.backgroundColor = '#fffbeb';
                resultDisplay.style.color = '#664d03';
            } else {
                resultDisplay.style.backgroundColor = '#e6f7ec';
                resultDisplay.style.color = '#1e462d';
            }
            
            resultDisplay.style.display = 'block';
            window.scrollTo(0, document.body.scrollHeight); // Cuộn xuống cuối trang để xem điểm
        }
    </script>

</body>
</html>
